$(function(){
  // build side menu
  var html = '<ul class="nav bs-docs-sidenav">';

  var level = 2;
  var thisLevel = 0;

  $('.one-col > h2, h3, h4').each(function() {
  		thisLevel = $(this).prop('tagName').substr(1);
  		console.log(thisLevel + ' ' + $(this).text());
  		for(i = level; i < thisLevel; i++)
  			html += '<ul class="nav">';

  		for(i = level; i > thisLevel; i--)
  			html += '</ul>';

      html+= '<li><a href="#' + $(this).attr('id') +'">'+ $(this).text() +'</a>';

		level = thisLevel;
  });

  for(i = level; i > 2; i--)
	 html += '</ul>';

  if (html == '') {
    $('[role=complementary]').hide();
    $('[role=main]').toggleClass('col-md-9 col-md-12');
  }
  else {
	  console.log('setting value');
    $('#aside-nav').html(html);
  }


  // Hook button
  $( "#content div.button" ).each(function( index ) {
    $(this).click(function() {
        window.location.href = $(this).attr('data-url');
        return false;
      });

      $(this).keypress(function(event) {
        if (event.which == 13 || event.which == 32) {
          window.location.href = $(this).attr('data-url');
          return false;
        }
      });
    });     

  /*!
   * JavaScript for Bootstrap's docs (http://getbootstrap.com)
   * Copyright 2011-2014 Twitter, Inc.
   * Licensed under the Creative Commons Attribution 3.0 Unported License. For
   * details, see http://creativecommons.org/licenses/by/3.0/.
   */
  !function(a){a(function(){if(navigator.userAgent.match(/IEMobile\/10\.0/)){var b=document.createElement("style");b.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.querySelector("head").appendChild(b)}{var c=a(window),d=a(document.body);a(".navbar").outerHeight(!0)+10}d.scrollspy({target:".bs-docs-sidebar"}),c.on("load",function(){d.scrollspy("refresh")}),a(".bs-docs-container [href=#]").click(function(a){a.preventDefault()}),setTimeout(function(){var b=a(".bs-docs-sidebar");b.affix({offset:{top:function(){var c=b.offset().top,d=parseInt(b.children(0).css("margin-top"),10),e=a(".bs-docs-nav").height();return this.top=c-e-d},bottom:function(){return this.bottom=a(".bs-docs-footer").outerHeight(!0)}}})},100),setTimeout(function(){a(".bs-top").affix()},100)})}(jQuery);
});
